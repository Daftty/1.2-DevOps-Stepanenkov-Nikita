# Домашнее задание к занятию "2.8 Ядро операционной системы"


---

### Задание 1

При каких событиях выполнение процесса переходит в режим ядра?

*Приведите ответ в свободной форме.*
#### Существуют три события, при которых выполнение процесса переходит в режим ядра: 1 - системные вызовы ( от пользовательских программ и управляют работой устройств); 2 - аппаратные прерывания (сигнализируют об окончании действий или ошабках со стороны устройств); 3 -  особые ситуации (вызваны самим процессом, и связаны с выполнением тех или иных инструкций, напр. деление на 0) 

---

### Задание 2

Найдите имя автора модуля `libcrc32c`.

*В качестве ответа приложите скриншот вывода команды.*

<img width="880" alt="image" src="https://user-images.githubusercontent.com/107577468/180871098-9645cb6a-e565-4b17-98e5-f2e0d6f3fd01.png">

<img width="590" alt="image" src="https://user-images.githubusercontent.com/107577468/180871691-e6b67d2f-eba0-4b65-b9a2-5a4e18ba0362.png">



---
### Задание 3

Используя утилиту `strace` выясните какой системный вызов использует команда `cd`.

*Примечание:* она не является внешним файлом, но для наших целей можно схитрить: `strace bash -c 'cd /tmp'`.

*В качестве ответа напишите название системного вызова.*

<img width="715" alt="Снимок экрана 2022-07-27 в 17 49 35" src="https://user-images.githubusercontent.com/107577468/181311086-cd94933d-a714-47da-bcae-4785087d370f.png">

#### Ответ: chdir. Также просьба уточнить, как это можно сделать путем strace -P или -e. У меня не получилось. 


---

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (необязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 4

**Соберите свой модуль и загрузите его в ядро.**

*Примечание:* лучше использовать чистую виртуальную машину, чтобы нивелировать шанс сломать систему.

**1) Установим необходимые пакеты:**

`apt-get install gcc make linux-headers-$(uname -r)`

**2) Создаем файл модуля:**

```
mkdir kmod-hello_world
cd kmod-hello_world/
touch ./mhello.c
```

```
#define MODULE
#include <linux/module.h>
#include <linux/init.h>
#include <linux/kernel.h>

MODULE_LICENSE("GPLv3");

int init_module(void){
    printk("<1> Hello,World\n");
    return 0;
}

void cleanup_module(void){
    printk("<1> Goodbye.\n");
}
```

**3) Создаем Makefile:**
`touch ./Makefile`

```
obj-m += mhello.o

hello-objs := mhello.c

all:
	make -C /lib/modules/$(shell uname -r)/build/ M=$(PWD) modules

clean:
	make -C /lib/modules/$(shell uname -r)/build/ M=$(PWD) clean
```
_Обратите внимание, что отступы перед `make` - это табуляция, а не пробелы. Для синтаксиса Makefile это важно._

**4) Собираем модуль и устанавливаем его с помощью insmod.**
```
make all
insmod path/to/module.ko
```

*В качестве ответа приложите скриншот вывода установки модуля в `dmesg`.*
#### Почему то выскачила ошибка. Делал через vim и nano. В vim не прржимался esc (интересно почему?) 
<img width="995" alt="Снимок экрана 2022-07-28 в 19 16 59" src="https://user-images.githubusercontent.com/107577468/181587801-b5c8b922-60cf-4d8f-bee1-abed675cacf6.png">
<img width="998" alt="Снимок экрана 2022-07-28 в 19 15 47" src="https://user-images.githubusercontent.com/107577468/181587824-73fd5d72-4244-4334-821e-b326556b3e69.png">

